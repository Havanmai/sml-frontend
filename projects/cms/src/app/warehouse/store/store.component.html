<cms-page title="Kho hàng" [close]="false">
  <div action>
    <a

      nz-button
      nzType="primary"
      class="mr-2"
      routerLink="way-bills"
      ><i nz-icon nzType="plus" nzTheme="outline"></i
      ><span class="d-none d-md-inline-block">Tạo phiếu</span></a
    >
   <!--  *ngxPermissionsOnly="['store:way-bills-creating']" -->
    <!-- <a nz-button nzType="primary" (click)="createBatch()" class="mr-2"
      ><img width="16px" src="/assets/excel 1.svg" class="mr-2" /><span
        class="d-none d-md-inline-block"
        >Nhập theo lô</span
      ></a
    > -->
    <a nz-button nzType="primary" routerLink="history-device"
      ><i nz-icon nzType="file-sync" nzTheme="outline"></i
      ><span class="d-none d-md-inline-block">Lịch sử</span></a
    >
  </div>
  <div content>
    <div nz-row class="mt-3" [nzGutter]="[16, 5]">
      <div
        nz-col
        [nzXs]="12"
        [nzSm]="7"
        [nzMd]="9"
        [nzLg]="7"
        [nzXl]="4"
        [nzXXl]="4"
        class="mt-3"
      >
        <nz-input-group [nzPrefix]="prefixIconSearch" class="width-full">
          <input
            type="text"
            [(ngModel)]="idDeviceSearch"
            nz-input
            placeholder="Mã hàng"
            (keyup.enter)="searchAll()"
          />
        </nz-input-group>
        <ng-template #prefixIconSearch>
          <i nz-icon nzType="search"></i>
        </ng-template>
      </div>
      <div
        nz-col
        [nzXs]="12"
        [nzSm]="7"
        [nzMd]="9"
        [nzLg]="7"
        [nzXl]="4"
        [nzXXl]="4"
        class="mt-3"
      >
        <nz-input-group [nzPrefix]="prefixIconSearch1" class="width-full">
          <input
            type="text"
            [(ngModel)]="batchNumberSearch"
            nz-input
            placeholder="Mã lô"
            (keyup.enter)="searchAll()"
          />
        </nz-input-group>
        <ng-template #prefixIconSearch1>
          <i nz-icon nzType="folder" nzTheme="outline"></i>
        </ng-template>
      </div>
      <div
        nz-col
        [nzXs]="12"
        [nzSm]="7"
        [nzMd]="9"
        [nzLg]="7"
        [nzXl]="4"
        [nzXXl]="4"
        class="mt-3"
      >
        <nz-select
          class="width-full"
          [(ngModel)]="modelSearch"
          nzAllowClear
          nzPlaceHolder="Danh mục"
        >
          <nz-option
            *ngFor="let m of listOfMenu"
            [nzLabel]="m.name"
            [nzValue]="m.id"
          ></nz-option>
        </nz-select>
      </div>
      <div
        nz-col
        [nzXs]="12"
        [nzSm]="7"
        [nzMd]="9"
        [nzLg]="7"
        [nzXl]="4"
        [nzXXl]="4"
        class="mt-3"
      >
        <nz-select
          class="width-full"
          [(ngModel)]="statusSearchValue"
          nzAllowClear
          nzPlaceHolder="Trạng thái"
        >
          <nz-option [nzLabel]="'Chưa xuất'" [nzValue]="0"></nz-option>
          <nz-option [nzLabel]="'Đã xuất'" [nzValue]="1"></nz-option>
          <nz-option [nzLabel]="'Hồi kho'" [nzValue]="2"></nz-option>
          <nz-option [nzLabel]="'Hỏng'" [nzValue]="3"></nz-option>
        </nz-select>
      </div>
      <div
        *ngIf="upgradesearch == true"
        nz-col
        [nzXs]="12"
        [nzSm]="7"
        [nzMd]="9"
        [nzLg]="7"
        [nzXl]="4"
        [nzXXl]="4"
        class="mt-3"
      >
        <nz-select
          class="width-full"
          [(ngModel)]="categorySearch"
          nzAllowClear
          nzPlaceHolder="Nhóm"
        >
          <nz-option
            *ngFor="let c of listOfCategory"
            [nzLabel]="c.name"
            [nzValue]="c.id"
          ></nz-option>
        </nz-select>
      </div>
      <div
        *ngIf="upgradesearch == true"
        nz-col
        [nzXs]="12"
        [nzSm]="7"
        [nzMd]="9"
        [nzLg]="7"
        [nzXl]="4"
        [nzXXl]="4"
        class="mt-3"
      >
        <nz-select
          class="width-full"
          nzPlaceHolder="Người nhập"
          nzAllowClear
          nzShowSearch
          nzServerSearch
          [(ngModel)]="importerSearch"
          (nzOnSearch)="onSearch($event)"
        >
          <ng-container *ngFor="let o of optionList">
            <nz-option
              *ngIf="!isLoading"
              [nzValue]="o.id"
              [nzLabel]="o.lastName.concat('', o.firstName)"
            ></nz-option>
          </ng-container>
          <nz-option *ngIf="isLoading" nzDisabled nzCustomContent>
            <i nz-icon nzType="loading" class="loading-icon"></i>
            Loading Data...
          </nz-option>
        </nz-select>
      </div>
      <div
        *ngIf="upgradesearch == true"
        nz-col
        [nzXs]="12"
        [nzSm]="12"
        [nzMd]="12"
        [nzLg]="12"
        [nzXl]="6"
        class="mt-3"
      >
        <nz-range-picker
          style="width: 97%"
          nzFormat="dd/MM/yyyy"
          [nzPlaceHolder]="['Từ ngày', 'Đến ngày']"
          ngModel
          (ngModelChange)="onChange($event)"
        ></nz-range-picker>
      </div>
      <div
        nz-col
        [nzXs]="12"
        [nzSm]="6"
        [nzMd]="10"
        [nzLg]="8"
        [nzXl]="6"
        [nzXXl]="4"
      >
        <a
          nz-button
          nzType="primary"
          class="px-3 mt-3 ml-2"
          (click)="searchAll()"
          ><i nz-icon nzType="search" nzTheme="outline"></i
          ><span class="d-none d-md-inline-block">Lọc</span></a
        >
        <a
          nz-button
          *ngIf="upgradesearch == false"
          nzType="default"
          class="mt-3 ml-3"
          (click)="upgradeSearch()"
          ><img width="16px" src="/assets/reverse.svg" /><span
            class="pl-2 d-none d-md-inline-block"
            >Nâng cao</span
          ></a
        >
        <a
          nz-button
          *ngIf="upgradesearch == true"
          nzType="default"
          class="mt-3 ml-3"
          (click)="upgradeSearch()"
          ><i nz-icon nzType="double-left" nzTheme="outline"></i
          ><span class="pl-2 d-none d-md-inline-block">Ẩn bớt</span></a
        >
      </div>
    </div>

    <div class="mt-5">
      <div nz-row class="info-wr">
        <div
          nz-col
          class="mr-3"
          nzFlex="4"
          *ngFor="let s of listOfSynthetic; let i = index"
          class="info-box"
        >
          <div *ngIf="i !== listOfSynthetic.length - 1" class="mt-4">
            <div style="text-align: center">
              <div>
                <img height="28px" src="/assets/{{ s.icon }}" />
              </div>
              <div class="mt-3">
                <span nz-typography>{{ s.nameSynthetic }}</span>
              </div>
              <div class="mt-0">
                <h5 nz-typography>{{ s.count | priceFormat }}</h5>
              </div>
            </div>
          </div>
          <div *ngIf="i === listOfSynthetic.length - 1" class="mt-4">
            <div style="text-align: center">
              <div>
                <img height="28px" src="/assets/{{ s.icon }}" />
              </div>
              <div class="mt-3">
                <span nz-typography>{{ s.nameSynthetic }}</span>
              </div>
              <div class="mt-0">
                <h5 nz-typography>{{ s.count | priceFormat }}</h5>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="mt-3">
      <!-- <div class="title-table my-3">
        <div class="mt-5 mr-3">
          <nz-badge
            [nzCount]="exportCount"
            nzShowZero
            nz-dropdown
            [nzDropdownMenu]="process"
            style="cursor: pointer"
          >
            <i
              nz-icon
              nzType="carry-out"
              style="font-size: 24px"
              nzTheme="outline"
            ></i>
          </nz-badge>
          <nz-dropdown-menu #process="nzDropdownMenu">
            <ul nz-menu nzSelectable>
              <ng-container *ngIf="exportCount > 0">
                <li
                  nz-menu-item
                  (click)="exportDivice()"
                  *ngIf="listDeviceId[0].status == 'Chưa xuất'"
                >
                  <i nz-icon nzType="upload" nzTheme="outline" class="mr-2"></i
                  >Xuất tất cả
                </li>
                <li
                  nz-menu-item
                  (click)="refund()"
                  *ngIf="listDeviceId[0].status != 'Chưa xuất'"
                >
                  <i
                    nz-icon
                    nzType="rollback"
                    nzTheme="outline"
                    class="mr-2"
                  ></i
                  >Hoàn tất cả
                </li>
                <li
                  nz-menu-item
                  (click)="tranfer()"
                  *ngIf="listDeviceId[0].status == 'Chưa xuất'"
                >
                  <i nz-icon nzType="swap" nzTheme="outline" class="mr-2"></i
                  >Chuyển kho tất cả
                </li>
              </ng-container>
              <ng-container *ngIf="exportCount == 0">
                <li nz-menu-item>Vui lòng chọn hàng</li>
              </ng-container>
            </ul>
          </nz-dropdown-menu>
        </div>
      </div> -->
      <div>
        <nz-table
          #rowSelectionTable
          [nzFooter]="footer"
          [nzFrontPagination]="false"
          [nzPageSize]="size"
          [nzPageIndex]="page"
          [nzTotal]="total"
          (nzPageIndexChange)="pageChange($event)"
          [nzData]="listOfData"
          [nzFooter]="footer"
          (nzCurrentPageDataChange)="onCurrentPageDataChange($event)"
          [nzScroll]="{ y: '100%' }"
        >
          <thead>
            <tr>
              <!-- <th
                [nzChecked]="false"
                [nzIndeterminate]="indeterminate"
                (nzCheckedChange)="onAllChecked($event)"
              ></th> -->
              <th>Mã</th>
              <th>Mã lô</th>
              <th>Danh mục</th>
              <th>Nhóm</th>
              <th>Màu</th>
              <th>Trọng lượng</th>
              <th>Kích thước</th>
              <th>Đơn giá</th>
              <th>Đơn vị</th>
              <th>Trạng thái</th>
              <th>Người nhập</th>
              <th>Ngày nhập</th>
              <!-- <th>Hành động</th> -->
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of rowSelectionTable.data">
              <!-- <td
                [nzChecked]="setOfCheckedId.has(data.id)"
                (nzCheckedChange)="onItemChecked(data, $event)"
              ></td> -->
              <!-- [nzDisabled]="(data.status==='Đã xuất')||(data.model.lockerCabinet==false)" -->
              <td>{{ data.id ? data.id : "-" }}</td>
              <td>{{ data.batchNumber ? data.batchNumber : "-" }}</td>
              <td>{{ data.model.name ? data.model.name : "-" }}</td>
              <td>
                {{ data.model.category.name ? data.model.category.name : "-" }}
              </td>
              <td>{{ data.color ? data.color : "-" }}</td>
              <td>{{ data.weight ? data.weight : "-" }}</td>
              <td>{{ data.dimension ? data.dimension : "-" }}</td>
              <td>{{ data.price | priceFormat }}</td>
              <td>{{ data.model.unit ? data.model.unit : "-" }}</td>
              <td>
                <nz-tag [nzColor]="data.status | colorStatus">{{
                  data.status | textStatus
                }}</nz-tag>
              </td>
              <td>
                {{
                  data.importedByUser.firstName
                    ? data.importedByUser.firstName
                    : "-"
                }}
              </td>
              <td>{{ data.importDate | dateChecked }}</td>
              <!-- <td>
                <i
                  nz-dropdown
                  [nzDropdownMenu]="menu"
                  nz-icon
                  nzType="more"
                  nzTheme="outline"
                  style="cursor: pointer"
                ></i>
                <nz-dropdown-menu #menu="nzDropdownMenu">
                  <ul nz-menu>
                    <li nz-menu-item>
                      <i
                        nz-icon
                        nzType="edit"
                        nzTheme="outline"
                        class="mr-2"
                      ></i
                      >Chỉnh sửa
                    </li>
                    <li nz-menu-item>
                      <i
                        nz-icon
                        nzType="read"
                        nzTheme="outline"
                        class="mr-2"
                      ></i
                      >Chi tiết
                    </li>
                    <ng-container *ngIf="data.status === 'Đã xuất'">
                      <li nz-menu-item (click)="refund()">
                        <i
                          nz-icon
                          nzType="rollback"
                          nzTheme="outline"
                          class="mr-2"
                        ></i
                        >Hoàn hàng
                      </li>
                    </ng-container>
                    <ng-container *ngIf="data.status != 'Đã xuất'">
                      <li nz-menu-item (click)="exportDivice()">
                        <i
                          nz-icon
                          nzType="upload"
                          nzTheme="outline"
                          class="mr-2"
                        ></i
                        >Xuất hàng
                      </li>
                      <li nz-menu-item (click)="tranfer()">
                        <i
                          nz-icon
                          nzType="swap"
                          nzTheme="outline"
                          class="mr-2"
                        ></i
                        >Chuyển kho
                      </li>
                    </ng-container>
                  </ul>
                </nz-dropdown-menu>
              </td> -->
            </tr>
          </tbody>
          <ng-template #footer>
            <span *ngIf="total">Tổng {{ total }} bản ghi</span>
          </ng-template>
        </nz-table>
      </div>
    </div>
  </div>
</cms-page>

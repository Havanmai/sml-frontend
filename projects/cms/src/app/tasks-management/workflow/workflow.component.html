<cms-page [title]="'Quản lý Workflow'" [close]="false">
  <div action>
    <a nz-button nzType="primary" class="mr-3" (click)="onCreate()"
      ><i nz-icon nzType="plus" nzTheme="outline"></i>
      <span class="d-none d-md-inline-block">Tạo mới</span></a
    >
  </div>

  <div content>
    <div class="my-3 pt-5">
      <nz-table
        #basicTable
        [nzData]="lstWorkflow"
        [nzFrontPagination]="false"
        [nzPageSize]="pageSize"
        [nzPageIndex]="pageNumber"
        [nzTotal]="totalPage"
        (nzPageIndexChange)="pageChange($event)"
        [nzFooter]="footer"
      >
        <thead>
          <tr>
            <th>STT</th>
            <th>Tên Workflow</th>
            <th>Ghi chú</th>
            <th nzWidth="160px">Hành động</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of basicTable.data; let i = index">
            <td>{{ (pageNumber - 1) * pageSize + i + 1 }}</td>
            <td>
              <a [routerLink]="'detail'">{{ data.name }}</a>
            </td>
            <td>{{ data.description }}</td>
            <td>
              <button
                nz-button
                nzType="text"
                class="mr-1"
                title="Sửa"
                (click)="onEdit(data)"
              >
                <i nz-icon nzType="edit" nzTheme="outline"></i>
              </button>
              <button
                nz-button
                nzType="text"
                title="Xóa"
                (click)="onDelete(data)"
              >
                <i
                  nz-icon
                  nzType="delete"
                  nzTheme="outline"
                  class="text-danger"
                ></i>
              </button>
            </td>
          </tr>
        </tbody>
        <ng-template #footer>
          <span *ngIf="totalPage">Tổng {{ totalPage }} bản ghi</span>
        </ng-template>
      </nz-table>
    </div>
  </div>
</cms-page>

<nz-modal
  [(nzVisible)]="isVisibleForm"
  [nzClosable]="false"
  nzTitle="Tạo mới workflow"
>
  <ng-container *nzModalContent>
    <form nz-form [formGroup]="mainForm" class="px-3">
      <nz-form-item>
        <nz-form-label [nzXs]="24" nzFor="name" nzRequired>
          <span>Tên workflow</span>
        </nz-form-label>
        <nz-form-control [nzXs]="24" nzErrorTip="Vui lòng nhập tên workflow!">
          <input
            nz-input
            class="pl-3"
            id="name"
            formControlName="name"
            placeholder="Nhập tên workflow"
          />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzXs]="24" nzFor="description">
          <span>Ghi chú</span>
        </nz-form-label>
        <nz-form-control [nzXs]="24">
          <textarea
            nz-input
            formControlName="description"
            id="description"
            name="description"
            placeholder="Nhập ghi chú"
          ></textarea>
        </nz-form-control>
      </nz-form-item>
    </form>
  </ng-container>
  <div *nzModalFooter>
    <button
      nz-button
      nzType="primary"
      (click)="onSubmit()"
      [nzLoading]="isLoading"
      class="m-2"
    >
      {{ isEdit ? "Cập nhập " : "Tạo mới" }}
    </button>
    <button nz-button nzType="default" (click)="onCancel()">Hủy</button>
  </div>
</nz-modal>

<cms-page [title]="'Quản lý Action'" [close]="false">
  <div action>
    <a nz-button nzType="primary" class="mr-3" (click)="onCreate()"
      ><i nz-icon nzType="plus" nzTheme="outline"></i>
      <span class="d-none d-md-inline-block">Tạo mới</span></a
    >
  </div>

  <div content>
    <div class="my-3 pt-5">
      <nz-table
        #basicTable
        [nzFrontPagination]="false"
        [nzPageSize]="pageSize"
        [nzPageIndex]="pageNumber"
        [nzTotal]="totalPage"
        (nzPageIndexChange)="pageChange($event)"
        [nzFooter]="footer"
        [nzData]="lstAction"
      >
        <thead>
          <tr>
            <th>STT</th>
            <th>Tên Action</th>
            <th>Trạng thái</th>
            <th>Key code</th>
            <th>Ghi chú</th>
            <th nzWidth="160px">Hành động</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of basicTable.data; let i = index">
            <td>{{ (pageNumber - 1) * pageSize + i + 1 }}</td>
            <td>
              {{ data.name }}
            </td>
            <td>
              <ng-container *ngIf="data.status !== null">
                <nz-tag [nzColor]="data.status == 1 ? 'green' : 'red'">{{
                  data.status == 1 ? "Active" : "Inactive"
                }}</nz-tag>
              </ng-container>
            </td>
            <td>{{ data.code }}</td>
            <td>{{ data.description }}</td>
            <td>
              <button
                nz-button
                nzType="text"
                class="mr-1"
                title="Sửa"
                (click)="onEdit(data)"
              >
                <i nz-icon nzType="edit" nzTheme="outline"></i>
              </button>
              <button
                nz-button
                nzType="text"
                title="Xóa"
                (click)="onDelete(data)"
              >
                <i
                  nz-icon
                  nzType="delete"
                  nzTheme="outline"
                  class="text-danger"
                ></i>
              </button>
            </td>
          </tr>
        </tbody>
        <ng-template #footer>
          <span *ngIf="totalPage">Tổng {{ totalPage }} bản ghi</span>
        </ng-template>
      </nz-table>
    </div>
  </div>
</cms-page>

<nz-modal
  [(nzVisible)]="isVisibleForm"
  [nzClosable]="false"
  nzTitle="Tạo mới Action"
>
  <ng-container *nzModalContent>
    <form nz-form [formGroup]="mainForm" class="px-3">
      <nz-form-item>
        <nz-form-label [nzXs]="24" nzFor="name" nzRequired>
          <span>Tên Action</span>
        </nz-form-label>
        <nz-form-control [nzXs]="24" nzErrorTip="Vui lòng nhập tên Action!">
          <input
            nz-input
            class="pl-3"
            id="name"
            formControlName="name"
            placeholder="Nhập tên Action"
          />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzXs]="24" nzFor="code" nzRequired>
          <span>Key Code</span>
        </nz-form-label>
        <nz-form-control [nzXs]="24" nzErrorTip="Vui lòng nhập key code!">
          <input
            nz-input
            formControlName="code"
            id="code"
            name="code"
            placeholder="Nhập KeyCode"
          />
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzXs]="24" nzFor="status">
          <span>Trạng thái</span>
        </nz-form-label>
        <nz-form-control [nzXs]="24">
          <nz-select
            class="width-full"
            nzShowSearch
            formControlName="status"
            nzPlaceHolder="Chọn trạng thái"
            nzAllowClear
          >
            <nz-option
              class="width-full"
              *ngFor="let o of lstStatus"
              [nzValue]="o.id"
              [nzLabel]="o.name"
            ></nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label [nzXs]="24" nzFor="description">
          <span>Ghi chú</span>
        </nz-form-label>
        <nz-form-control [nzXs]="24">
          <textarea
            nz-input
            formControlName="description"
            id="description"
            name="description"
            placeholder="Nhập ghi chú"
          ></textarea>
        </nz-form-control>
      </nz-form-item>
    </form>
  </ng-container>
  <div *nzModalFooter>
    <button
      nz-button
      nzType="primary"
      (click)="onSubmit()"
      [nzLoading]="isLoading"
      class="m-2"
    >
      {{ isEdit ? "Cập nhập " : "Tạo mới" }}
    </button>
    <button nz-button nzType="default" (click)="onCancel()">Hủy</button>
  </div>
</nz-modal>
